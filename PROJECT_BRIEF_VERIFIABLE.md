# Project Brief (Verifiable)

## Project Summary
- HEALTH is an AI-powered mobile healthcare navigation app that lets Naga City residents describe symptoms, see recommended care levels, browse the city’s facility directory, follow a YAKAP enrollment guide, and work offline when needed, matching the feature list in the README (README.md:3; README.md:18; README.md:19; README.md:20; README.md:21).

## Project Statement
- The code emphasizes AI triage, curated facility data, YAKAP guidance, and offline continuity because those flows are the explicitly documented outcomes the app delivers for Naga City residents who need trustworthy direction on where to seek care (README.md:18; README.md:19; README.md:20; README.md:21).

## Solution Overview
- `App.tsx` wires the Redux store, PersistGate, and SafeAreaProvider, listens for connectivity changes via NetInfo, and launches the initial facility sync before rendering the navigation tree, so offline awareness and safety modals are always active from startup (App.tsx:9; App.tsx:15; App.tsx:113; App.tsx:124).
- `syncService` drives facility refreshes by calling the backend API, storing the payload in SQLite, and writing a timestamp that the offline slice exposes, while `database.ts` defines local tables for facilities, emergency contacts, clinical notes, and medications to back those offline flows (src/services/syncService.ts:1; src/services/database.ts:1).
- `facilityService` prefers fresh API data but falls back to the cached SQLite rows while also sending visitor signals, keeping the directory usable even when offline (src/services/facilityService.ts:1).
- The assessment flow talks to Google Gemini through `geminiClient`, which applies prompts, caching, and rate limits to generate follow-up questions and recommendations that the triage screens render (src/api/geminiClient.ts:1).
- Express exposes `/api/assessments`, `/api/facilities`, `/api/symptoms`, `/api/ai`, `/api/yakap`, `/api/emergency-contacts`, and `/api/feed`, and the backend `aiService` also uses Gemini plus structured facility filters to pair recommendations with specific clinics before Prisma persists the facility, symptom, emergency contact, health feed, and clinical history models in PostgreSQL (backend/src/app.ts:1; backend/src/routes/index.ts:1; backend/src/services/aiService.ts:1; backend/src/services/aiService.ts:35; backend/src/routes/facilityRoutes.ts:1; backend/src/services/facilityService.ts:1; backend/src/services/healthFeedService.ts:1; backend/prisma/schema.prisma:1; backend/prisma/schema.prisma:6; backend/prisma/schema.prisma:7).

## Features
1. **AI Symptom Assessment & Triage** – `CheckSymptomScreen` captures typed symptom descriptions while running emergency and crisis detectors, then hands off to `SymptomAssessmentScreen`, which uses `TriageEngine`, `TriageArbiter`, and the Gemini client to drive follow-up questions, readiness scoring, and the subsequent recommendation UI (src/features/navigation/CheckSymptomScreen.tsx:16; src/features/navigation/CheckSymptomScreen.tsx:23; src/features/navigation/CheckSymptomScreen.tsx:172; src/features/navigation/CheckSymptomScreen.tsx:201; src/screens/SymptomAssessmentScreen.tsx:52; src/screens/SymptomAssessmentScreen.tsx:71; src/screens/SymptomAssessmentScreen.tsx:2135; src/services/triageEngine.ts:1; src/services/triageArbiter.ts:1; src/api/geminiClient.ts:1; backend/src/services/aiService.ts:1; src/screens/RecommendationScreen.tsx:1).
2. **Facility Directory with Live Metrics & Offline Sync** – Filters, distance sorting, and facility selection live in `facilitiesSlice`, which loads data through `facilityService`, caches it via `database.ts`, and syncs on startup; the backend facility routes and Prisma Facility model supply the origin data (src/store/facilitiesSlice.ts:1; src/services/facilityService.ts:1; src/services/database.ts:1; src/services/syncService.ts:1; backend/src/routes/facilityRoutes.ts:1; backend/src/services/facilityService.ts:1; backend/prisma/schema.prisma:1).
3. **YAKAP Enrollment Guide** – `YakapHomeScreen`, `YakapGuidePathsScreen`, and `YakapGuideStepsScreen` render the content defined in `yakapContent.ts` and surface FAQ/help links while the backend’s `yakapService` returns the canonical program details (src/features/yakap/YakapHomeScreen.tsx:1; src/features/yakap/YakapGuidePathsScreen.tsx:1; src/features/yakap/YakapGuideStepsScreen.tsx:1; src/features/yakap/YakapFaqScreen.tsx:1; src/features/yakap/yakapContent.ts:1; backend/src/services/yakapService.ts:1).
4. **Health News Hub** – `HealthHubScreen` displays the Redux feed, which fetches paginated entries via `healthFeedService`; backend scraping keeps the `HealthFeed` table populated so the endpoint always returns the latest local updates (src/screens/HealthHubScreen.tsx:1; src/store/feedSlice.ts:1; src/services/healthFeedService.ts:1; backend/src/services/healthFeedService.ts:1).
5. **Medication Tracking** – `MedicationTrackerScreen` lets users add, delete, and mark medications while `medicationSlice` persists records to SQLite so they remain available offline (src/screens/MedicationTrackerScreen.tsx:1; src/store/medicationSlice.ts:1; src/services/database.ts:1).
6. **Emergency & Mental Health Safety** – `CheckSymptomScreen` calls `detectEmergency` and `detectMentalHealthCrisis`, and `CrisisSupportScreen` presents hotline contacts defined by the mental health detector so the UI can route high-risk journeys to immediate help (src/features/navigation/CheckSymptomScreen.tsx:172; src/features/navigation/CheckSymptomScreen.tsx:201; src/services/emergencyDetector.ts:1; src/services/mentalHealthDetector.ts:1; src/screens/CrisisSupportScreen.tsx:1).
7. **Offline State & Clinical History** – The offline slice logs connectivity, last sync, and the latest clinical note; `App.tsx` dispatches those updates while `database.ts` stores the clinical history rows that the `RecommendationScreen` can save after each assessment (src/store/offlineSlice.ts:1; App.tsx:113; src/services/database.ts:1).

## Tech Stack
- **Frontend:** React Native 0.81.5, Expo SDK 54, React 19.1.0, Redux Toolkit 2.11.2, Firebase App, axios, and SQLite caching/Redux Persist dependencies declared in `package.json` (package.json:25; package.json:29; package.json:47; package.json:50; package.json:20; package.json:43; package.json:62).
- **Backend:** Express 5.2.1, Prisma 7.3.0, Firebase Admin, rate limiting, cron, and PostgreSQL client libraries plus the `@google/generative-ai` client listed in `backend/package.json` (backend/package.json:22; backend/package.json:21; backend/package.json:29; backend/package.json:32).
- **Database:** PostgreSQL via Prisma’s schema, which defines Facility, Symptom, EmergencyContact, HealthFeed, ClinicalHistory, and related models (backend/prisma/schema.prisma:1; backend/prisma/schema.prisma:6; backend/prisma/schema.prisma:7).
- **AI:** Google Gemini 2.5 Flash is used on both client (`geminiClient`) and server (`aiService`), with the shared dependency declared in both package files (src/api/geminiClient.ts:1; backend/src/services/aiService.ts:1; package.json:16; backend/package.json:21).
- **Infrastructure & Sync:** Offline resilience relies on Expo SQLite, Redux Persist, and the offline slice, while the express backend hosts `/api` routes and the health feed scraper described above (package.json:43; package.json:62; src/services/database.ts:1; src/services/syncService.ts:1; src/store/offlineSlice.ts:1; backend/src/app.ts:1; backend/src/routes/index.ts:1).

## Target Users
- The README explicitly targets Naga City residents, and the AI prompt used by the backend triage service speaks directly to “Naga City” care pathways, so confirmed users are local residents seeking guidance on care levels, facilities, and YAKAP enrollment (README.md:3; backend/src/services/aiService.ts:35).
